// =============================================
// 新機能テスト
// =============================================

// --- 1. ラムダ（無名関数）---
表示("=== ラムダ（無名関数）===")
変数 二倍 = 関数(x):
    戻す x * 2
終わり
表示("二倍(5) =", 二倍(5))

変数 加算 = 関数(a, b):
    戻す a + b
終わり
表示("加算(3, 4) =", 加算(3, 4))

// --- 2. 高階配列関数 ---
表示("")
表示("=== 高階配列関数 ===")
変数 数列 = [1, 2, 3, 4, 5]

// 変換（map）
変数 二倍配列 = 変換(数列, 関数(x):
    戻す x * 2
終わり)
表示("変換 [1,2,3,4,5] * 2 =", 二倍配列)

// 抽出（filter）
変数 偶数 = 抽出(数列, 関数(x):
    戻す x % 2 == 0
終わり)
表示("抽出 偶数 =", 偶数)

// 集約（reduce）
変数 合計 = 集約(数列, 関数(acc, x):
    戻す acc + x
終わり, 0)
表示("集約 合計 =", 合計)

// 反復（forEach）
表示("反復:")
反復(数列, 関数(x):
    表示("  要素:", x)
終わり)

// --- 3. 選択文（switch）---
表示("")
表示("=== 選択文（switch）===")
変数 曜日 = 3

選択 曜日:
    場合 1:
        表示("月曜日")
    場合 2:
        表示("火曜日")
    場合 3:
        表示("水曜日")
    場合 4:
        表示("木曜日")
    場合 5:
        表示("金曜日")
    既定:
        表示("週末")
終わり

// --- 4. 各要素ループ（foreach）---
表示("")
表示("=== 各要素ループ（foreach）===")
変数 果物 = ["りんご", "みかん", "ぶどう"]

各 果物名 を 果物 の中:
    表示("果物:", 果物名)
終わり

// 文字列の各文字
表示("文字列ループ:")
各 文字 を "こんにちは" の中:
    表示("  文字:", 文字)
終わり

// 辞書のキーループ
変数 辞書 = {"名前": "太郎", "年齢": "25"}
表示("辞書キーループ:")
各 項目 を 辞書 の中:
    表示("  キー:", 項目)
終わり

// --- 5. 正規表現 ---
表示("")
表示("=== 正規表現 ===")
変数 文 = "電話番号は03-1234-5678です"

// 正規一致
表示("正規一致 'abc' に '[a-z]+' :", 正規一致("abc", "[a-z]+"))
表示("正規一致 '123' に '[a-z]+' :", 正規一致("123", "[a-z]+"))

// 正規検索
変数 結果 = 正規検索(文, "[0-9]+-[0-9]+-[0-9]+")
表示("正規検索 電話番号:", 結果)

// 正規置換
変数 置換後 = 正規置換("Hello World 123", "[0-9]+", "XXX")
表示("正規置換:", 置換後)

// --- 6. システムユーティリティ ---
表示("")
表示("=== システムユーティリティ ===")

// 環境変数
変数 ホーム = 環境変数("HOME")
表示("HOME:", ホーム)

// コマンド実行
変数 出力 = 実行("echo テスト出力")
表示("実行結果:", 出力)

// 環境変数設定
環境変数設定("JP_TEST", "テスト値")
表示("JP_TEST:", 環境変数("JP_TEST"))

// --- 7. コマンドライン引数 ---
表示("")
表示("=== コマンドライン引数 ===")
表示("引数:", 引数)

表示("")
表示("=== 全テスト完了 ===")
