# はじむ ロードマップ

> 🇺🇸 **English version available:** [ROADMAP_en.md](ROADMAP_en.md)

## 実装予定の機能一覧

最終更新: 2026年2月7日

---

## 🔴 最優先（ユーザー要望）

| # | 機能 | 状態 | 説明 |
|---|---|---|---|
| 1 | **非同期処理** | ✅ 完了 | `非同期実行`/`待機`/`全待機` キーワードによる非同期関数の定義と実行 |
| 2 | **WebSocket** | ✅ 完了 | WebSocketクライアント機能（`WS接続`, `WS送信`, `WS受信`, `WS切断`） |
| 3 | **並列処理** | ✅ 完了 | スレッドベースの並列実行（`並列実行`, `排他作成`, `排他実行`） |
| 4 | **スケジューラ** | ✅ 完了 | タスクスケジューリング（`定期実行`, `遅延実行`, `スケジュール停止`） |

---

## 🟠 高優先度（基本言語機能）

| # | 機能 | 状態 | 説明 |
|---|---|---|---|
| 5 | **`super` 呼び出し** | ✅ 完了 | `親.メソッド名(引数)` で親クラスのメソッドを呼び出す |
| 6 | **REPL改善** | ✅ 完了 | 複数行入力、ヒストリ、色付き出力、履歴コマンド |
| 7 | **スタックトレース** | ✅ 完了 | エラー時に呼び出し履歴を表示 |
| 8 | **負のインデックス** | ✅ 完了 | `配列[-1]` で最後の要素にアクセス |
| 9 | **三項演算子** | ✅ 完了 | `条件 ? 値A : 値B` |
| 10 | **可変長引数** | ✅ 完了 | `関数 合計(*数列):` |
| 11 | **カスタム例外** | ✅ 完了 | `例外作成(種類, メッセージ)` で構造化例外を作成 |
| 12 | **分解代入** | ✅ 完了 | `変数 [a, b] = [1, 2]` |
| 13 | **`始まる`/`終わる`** | ✅ 完了 | startsWith/endsWith 相当 |
| 14 | **`部分文字列`** | ✅ 完了 | substring 組み込み関数 |

---

## 🟡 中優先度（実用性向上）

| # | 機能 | 状態 | 説明 |
|---|---|---|---|
| 15 | **Null合体演算子** | ✅ 完了 | `値 ?? "既定値"` |
| 16 | **`全て()`/`一つでも()`** | ✅ 完了 | every/some 配列条件判定 |
| 17 | **カスタム比較ソート** | ✅ 完了 | `比較ソート(配列, 比較関数)` |
| 18 | **ファイル追記** | ✅ 完了 | `追記(パス, 内容)` |
| 19 | **ディレクトリ操作** | ✅ 完了 | `ディレクトリ一覧()`, `ディレクトリ作成()` |
| 20 | **三角関数・対数・定数** | ✅ 完了 | `正弦()`, `余弦()`, `対数()`, `円周率` |
| 21 | **辞書キー・値ペア展開** | ✅ 完了 | `各 キー, 値 を 辞書 の中:` |
| 22 | **`instanceof` 型判定** | ✅ 完了 | `型判定(オブジェクト, "クラス名")` |
| 23 | **`表明()` (assert)** | ✅ 完了 | テスト・検証用アサーション |
| 24 | **モジュール名前空間** | ✅ 完了 | `取り込む "ファイル" として モジュール名` |
| 25 | **`%=` / `**=` 複合代入** | ✅ 完了 | 演算子の一貫性 |
| 26 | **乱数整数** | ✅ 完了 | `乱数整数(1, 100)` |
| 27 | **スプレッド演算子** | ✅ 完了 | `関数呼び出し(...配列)` |
| 28 | **`探す`/`圧縮`/`一意`** | ✅ 完了 | find / zip / unique |
| 29 | **`末尾削除` (pop)** | ✅ 完了 | 配列の末尾を削除して返す |

---

## 🟢 低優先度（発展的機能）

| # | 機能 | 状態 | 説明 |
|---|---|---|---|
| 30 | 列挙型 (enum) | ✅ 完了 | `列挙 色: 赤 青 緑 終わり` |
| 31 | パターンマッチング | ✅ 完了 | `照合 値: 場合 パターン => 処理 終わり` |
| 32 | ジェネレータ / yield | ✅ 完了 | `生成関数` / `譲渡` / `次()` / `完了()` / `全値()` |
| 33 | デコレータ | ✅ 完了 | `@デコレータ 関数 計算():` |
| 34 | 静的メソッド | ✅ 完了 | `静的 関数 作成():` |
| 35 | アクセス修飾子 | ✅ 完了 | `_`プレフィックスによるプライベートフィールド |
| 36 | 演算子オーバーロード | ✅ 完了 | `足す`/`引く`/`等しい`等のメソッドで演算をカスタマイズ |
| 37 | セット (集合) 型 | ✅ 完了 | `集合(1, 2, 3)`, 和集合/積集合/差集合 |
| 38 | 16進・2進リテラル | ✅ 完了 | `0xFF`, `0b1010` |
| 39 | テストフレームワーク | ✅ 完了 | `テスト(名前, 関数)`/`テスト実行()`/`期待()` |
| 40 | toString プロトコル | ✅ 完了 | `文字列化` メソッドによるオブジェクト表示のカスタマイズ |
| 41 | Base64 / ハッシュ | ✅ 完了 | `Base64エンコード()`, `Base64デコード()` |
| 42 | パス操作 | ✅ 完了 | `パス結合()`, `ファイル名()`, `ディレクトリ名()`, `拡張子()` |
| 43 | ドキュメントコメント | ✅ 完了 | `文書化(名前, 説明)`/`文書(名前)` |
| 44 | 型エイリアス | ✅ 完了 | `型別名("整数", "数値")` 型判定でエイリアス解決 |
| 45 | パッケージ管理 | ✅ 完了 | 内蔵パッケージマネージャ（`hajimu パッケージ 初期化/追加/削除/一覧/インストール`）、`取り込む` のパッケージ解決拡張 |
| 46 | C拡張プラグイン | ✅ 完了 | 統一 `.hjp` 形式のクロスプラットフォームプラグイン、拡張子なしインポート、C/C++/Rust等で開発可能 |

---

## 進捗サマリー

- **完了**: 46/46 (100%) 🎉
- **テスト**: 170テスト全通過 (基本20 + 新機能150)

---

## 🔮 将来構想

### クロスプラットフォームパッケージ配布 (v1.3.0 実装済み)

| 方式 | 状態 | 説明 |
|---|---|---|
| HJPB バイトコード | ✅ v1.3.0 | `.jp` スクリプトを HJPB 封入でクロスプラットフォーム配布 |
| 純粋スクリプトパッケージ | ✅ v1.3.0 | `メイン: main.jp` のみで全 OS 動作 |
| GitHub Actions CI 配布 | ✅ v1.3.0 対応 | C/C++/Rust プラグインを macOS/Linux/Windows ごとにビルドして Releases に自動アップロード。`hajimu pkg add` でユーザーの OS に合ったビルド済みバイナリを自動ダウンロード |

### SDL2/OpenGL のはじむ本体への内蔵 (将来構想)

現在のプラグイン方式（C で書いた `.hjp` をダイナミックロード）では、SDL2 や OpenGL を使うエンジン系パッケージは GitHub Releases でプラットフォーム別バイナリを配布する必要があります。

将来的には、**SDL2・OpenGL・miniaudio などの描画/音声ライブラリをはじむインタープリター本体に静的リンクで内蔵**することで、エンジン系パッケージも jp スクリプトとして HJPB に収録でき、真の「1ファイル・全プラットフォーム動作」を実現できます。

```
将来のはじむ (SDL2 内蔵版):
  nihongo 勤怠アプリ.jp    ← .jp スクリプト 1 ファイル
  hajimu pkg add jp-gui   ← hajimu_gui.hjp (HJPB = jp スクリプト)
  → Windows/macOS/Linux 全てで動作
```

**実現に必要な変更:**
- はじむインタープリターに SDL2 / OpenGL / miniaudio を静的リンク
- エンジンパッケージを jp スクリプトで書き直し（既存 C コードを捨てる大規模リファクタ）
- はじむバイナリサイズの増大を許容（+5〜15 MB）

**Unity / Flutter と同等の設計思想であり、はじむが目指す長期的なゴールのひとつです。**

| 項目 | 現在 (v1.3.x) | 将来 (SDL2 内蔵版) |
|---|---|---|
| エンジン配布 | GitHub Releases (OS 別バイナリ) | HJPB スクリプト (1 ファイル) |
| インタープリターサイズ | 〜1 MB | 〜15 MB |
| GPU アクセス | ネイティブ C プラグイン | jp スクリプトから直接 |
| 実装難易度 | — | 非常に大きい |
